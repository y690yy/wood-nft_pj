<!DOCTYPE html>
<html>
<head>
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const markers = [
        {
          patt: "aruco_generater/240223_aruco_generated_patt/aruco_0.patt",
          images: [
            {
              src: "ntf_figures/figure_001.png",
              position: "0 0 0",
              rotation: "180 0 0",
              link: "https://woodnft.github.io/woodnft-demo/#/CardDetailPage/1"
            },
            {
              src: "ntf_figures/figure_002.png",
              position: "0 0 0",
              rotation: "180 0 0",
              link: "https://woodnft.github.io/woodnft-demo/#/CardDetailPage/2"
            },
            {
              src: "ntf_figures/figure_003.png",
              position: "0 0 0",
              rotation: "180 0 0",
              link: "https://woodnft.github.io/woodnft-demo/#/CardDetailPage/3"
            },
            {
              src: "ntf_figures/figure_004.png",
              position: "0 0 0",
              rotation: "180 0 0",
              link: "https://woodnft.github.io/woodnft-demo/#/CardDetailPage/4"
            },
            {
              src: "ntf_figures/figure_005.png",
              position: "0 0 0",
              rotation: "180 0 0",
              link: "https://woodnft.github.io/woodnft-demo/#/CardDetailPage/5"
            }
          ]
        }
      ];

      markers.forEach((marker, index) => {
        const scene = document.querySelector("a-scene");
        const aMarker = document.createElement("a-marker");
        aMarker.setAttribute("type", "pattern");
        aMarker.setAttribute("url", marker.patt);
        aMarker.setAttribute("id", `marker-${index}`);

        let currentImageIndex = 0;
        const displayNextImage = () => {
          // Remove any existing image before adding a new one
          const existingImage = aMarker.querySelector("a-image");
          if (existingImage) {
            aMarker.removeChild(existingImage);
          }

          if (currentImageIndex >= marker.images.length) {
            currentImageIndex = 0; // Reset index to loop
          }

          const image = marker.images[currentImageIndex];
          const aImage = document.createElement("a-image");
          aImage.setAttribute("src", image.src);
          aImage.setAttribute("width", "1");
          aImage.setAttribute("height", "1");
          aImage.setAttribute("position", image.position);
          aImage.setAttribute("rotation", image.rotation);
          aImage.setAttribute("scale","2 2 0");

          aImage.addEventListener("click", (event) => {
            event.stopPropagation();
            window.location.href = image.link;
          });

          aMarker.appendChild(aImage);

          currentImageIndex++;
          setTimeout(displayNextImage, 1000); // Display next image after 1 second
        };

        // Start the image display loop
        displayNextImage();

        scene.appendChild(aMarker);
      });
    });
  </script>
</head>
<body>
  <a-scene embedded arjs="patternRatio:0.80" vr-mode-ui="enabled: false">
    <a-entity camera cursor="fuse: false; rayOrigin : mouse;"></a-entity>
  </a-scene>
</body>
</html>
